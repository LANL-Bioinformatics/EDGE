# EDGE-COVID19

## build 2021

## build 20211130
* update Tomcat 7.0.92 to 7.0.109 for vulnerable patch
* update pangolin to 3.1.16
* fix bug on vaccined_received metadata parsing
* fix bug on consensus composition file parsing
* add Varskip primer scheme option for trimming
* fix SNP count for consensus
* update privacy policy
* use unlimit coverage to consensus
* align_trim on short amplicon reads length > amplicon size.  check the primer pair  name should be a set for trimming
* use align_trim bam file for downstream instead of rerun mapping again
* add varlog option for consensus workflow
* add homopolymer filter and strandBias filter for consensus workflow
* add option for panglin lineage assingment mode, usher or pangoLearn
* update VOC for B.1.1.1529 Omicron

## build 20211001
* cleanup intermediate files
* add privacy-policy info
* add projects report plots package and function
* add frameshift confirmation option for GISAID upload
* add cov tracker configuartion option and result page
* add GISAID/NCBI batch submit status check. append the exit screenshot to the log windown for submission 
* fix bug bioproject parsing error for SRA upload
* SRA download SRA/ENA inconsistency check with WARNING
* Update VOC/VOI/VUM
* Add vaccine received metadata field
* optimized countFastq method to avoid out of memory for large dataset

## build 20210823
* update ENA portal api URL for metadata checking
* Add Pacbio support of ec-19
* Add Pacbio Freed (Midnight) primer bed for align_trim
* add annotation on amplicon_coverage plot (amplicov 0.3.1)
* filter length=0 from SRA download reads
* input duplicate id check
* update VOC and VOI
* check platform for batch submit
* update pangolin to 3.1.11
* add guest account log option


## build 20210713
* variant call using default diploid mode, add VCF QUAL filter
* add rerun pangolin lineage assignment function in project action widget
* update VOC and VOI
* update pangolin to 3.1.5 and its dependencies
* add artic protocol primer scheme v4 for align_trim
* SNV_report and INDEL_report display in pop up table
* fix bug: align_trim deal with short amplicon and off by 1 issue
* fix bug: deletion check condition. at least covTresh on previous delete event
* fix bug: consensus off by 1 bug when deletion detected after any insertion event. 

## build 20210607
* add early stop codon aa substitution warning
* add ampliseq adapter
* add aligntrim info on header of result section
* update NCBI batch submitter: add auto-delete option
* Align_trim deal with amplicon_size < read length
* add confirmation pop up before gisaid/genbank submission
* fix genome/sra submission. run in background
* fix empty sample_title when performing SRA submssion
* update Pangolin to 3.0.3 and add its dependencies 
* add metadata input for batch submit, update example EXCEL file with
instructions
* add small test dataset for covid19
* update NCBI genome submission script to work with new NCBI login

## build 20210505
* Batch NCBI SRA submission.
* fix gisaid/NCBI genome submission corresponding to the GISAID/NCBI GUI udpate
* fix bug: fix missing primer scheme fasta files
* add frameshift column for INDELs_report. fix bug on amplicov
* update gisaid batch upload template
* update VOC and VOI check

## build 20210407
* Lowered default threshold for detecting indels in amplicon-based ONT data to 0.6 (from 0.8)
* Add swift primer trim option
* Add Pangolin lineage assignment for consensus genome
* Add INDEL frameshfit warning and link to indel report
* SNP analysis on consenesus changelog with ambiguous code
* Add lineage result link to outbreak.info lineage report
* Add Single project NCBI SRA submission at the project action widget (https://edge-covid19.edgebioinformatics.org/)
* Add Bioproject ID and release-date selection for NCBI genome submission

## build 20210216
* Add funding acknowledgement in about page
* Incorrect uses of align_trim on Illumina samples while trimming the ARTIC primers was fixed by making the trimming strand specific. We recommend rerunning your samples if it was generated using Illumina following the ARTIC protocol.
* Avoid genbank2gff3 write tmp file to read-only system
* Change the working directory to outdir for CharliesCloud, the read-only container
* Disabled filtering alignments based on BAQs for samples sequenced using Illumina also. Now, all the sequences This was causing coverage reduction in location around indels.

## build 20201223
* Fix bug: batch metadata page project link
* Fix bug: mapping with long reads flag --long for minimap2 and nanopore data
* add MD flag for minimap2 on run Reads to Contigs
* Rename SNPs -> SNVs.
* Consensus with deletion and IUPAC

## build 20201130
* Add --comp option for command line consensus_fasta
* Update remote UShER URL and check server status
* Fix GISAID/NCBI upload bugs
* Multiple projects report in tables. (“Reports” on menu)
* Fix bug: auto_run block by failure rerun
* Update url for ena api
* Add Batch submission of SRA projects.
* Fix minimap2 se reads mapping options
* Add --remove_softclip flag for bam_to_fastq script, and if align_trim is on, it will align_trim use NC_0045512, extract reads with soft-clipped removed, and map back to NC_0045512 and GISAID genome

## build 20201007
* Avoid duplicate metadata field between batch submit and single project submit
* Update GISAID/NCBI submit and add NCBI/GISAID genome batch submit
* Update tooltip desc of batch submit
* Amplicov default to unique coverage plot
* Add ambiguous option for consensus
* Added capability to quickly check the phylogenetic placement of SARS-CoV-2 genomes against a well maintained reference phylogeny using Usher.

## build 2020903
* Udpate ENA API fields return for sra download
* Specific biopython verison to 1.76 for python2 compatiblity
* Fix reconfig error
* Clean error msg before udpate project info
* Avoid Prototype mismatch: sub main::head CGI warning
* Refresh the error msg for edge_info while ajax error
* Add flye GUI option.

## build 20200806
* Add EDGE-covid19 in the ASM METHOD for GISAID upload
* Add time zone info
* Add memory constrain for samtools sort
* Add GISAID submission status check
* Add batch metadata download/update function
* Add GISAID batch upload function. 
* Avoid gff id not unique in the JBrowse track generating
* Add NCBI source.src and comment.cmt, seq.fasta file for metadata download

## build 20200708
* Allow bed file upload and format check
* Add CDC primer scheme.
* Default pcr dedup off when primer scheme been used for align_trim
* Minimum consensus coverage to samtools mpileup default 8000
* Minimum trim length to 350 for ONT data
* Add pysam and amplicon_coverage.py for html output
* Update user tutorial pdf
* Update amplicon_coverage with colors for 5x below bar
* Add GUI button for Adjust system properties CPU
* Add GUI button for Clean the my upload files functions.
* Add upload dir max limit

## build 20200603
* Disable BAQ calculation for ONT data
* Add error msg when miniasm failed
* Add MAINTENANCE warning
* Add disable BAQ option and INDELs threshold options on GUI
* Add samclip to clip by max threshold. default 50, adjust to 150 for Nanopore
* Add align_trim to trim primer by BED file cooridinates
* Add primer track in JBrowse in BED file is used.
* Add primer trim method switch on GUI, FaQCs or Align_trim
* Add artic bed v1,v2,v3 files
* Removed tail polyA end 33 nt from the NC_045512. ref seq genome
* Allow upload bed file with first line contains #bed and bed 6+ column format check
* Add the PCR deduplicates switch on GUI
* Add the MaxClip option on GUI
* Fix bug on reconfig with provided contig.
* Update runReadsToContig with maxClip option
* Update runReadsToGenome with maxClip and align_trim_bed_file option
* Fix MD tag using samtools calmd for JBrowse
* Update user guide pdf file

## build 20200510
* Check nanopore JBrowse it is the minimap2 need to add --MD for minimap2
* Split N to gap “n” and ambiguous “N”
* Update change log to include zero reads support “n”
* Filter bwa alignement with 60, bowtie 42
* Subsample bam for JBrowse
* Fix annotation bug with user provided contig id
* Turn off annotation by default
* Update JBrowse to 1.16.8
* min_depth=5 . turn on -A orphan reads for variant call in runReadsToGenomes.pl
* Add host removal

## build 20200423
* Install jq for faster dynamic search (8x) but case sensitive.
* Add switch for preselected NCBI RefSeq genome
* Update About page
* Add option to Trim ARTIC Protocol Primers in QC module
* Move the consensus minCov and alt-ration option to main parameters
* Remove Identify Unmapped Reads options (full EDGE version function)
* Fix warning message with 'source' (bash) cannot be found
* Update user guide pdf file
* Color the 'additional option'

## build 20200419
* First release version based on EDGE v2.4.0 platform
